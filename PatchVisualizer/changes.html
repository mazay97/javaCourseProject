<!DOCTYPE html>
<html>
    <head>
        <title>Unified</title>
        <style type="text/css">
            table {
             background: white; /* Цвет фона таблицы */
            }
            .deleted {
             background: rgb(233, 120, 120); /* Цвет фона ячеек */
             padding: 5px; /* Поля вокруг текста */
            }
            .added {
             background: greenyellow; /* Цвет фона ячеек */
             padding: 5px; /* Поля вокруг текста */
            }
        </style>
    </head>
<body>

<h2>File:  Game/Level.cpp | 8 ++------</h2><h2>Date:  Mon, 23 Jan 2017 11:46:15 +0300</h2><h2>Author:  term96 <term96@yandex.com></h2>    <table>
<tr>
<td>1</td>
<td>1</td>
<td>#include "Level.h"</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>#include <Windows.h></td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>#include <math.h></td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>#include "Resources.h"</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>6</td>
<td>using namespace std;</td>
</tr>
<tr>
<td>7</td>
<td>7</td>
<td>using namespace sf;</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>9</td>
<td>CLevel::CLevel(RenderWindow & window)</td>
</tr>
<tr>
<td>10</td>
<td>10</td>
<td>	:m_player(new CPlayer(Vector2f(WINDOW_WIDTH / 2 - PLAYER_WIDTH / 2, PLAYER_START_HEIGHT), m_lasers))</td>
</tr>
<tr>
<td>11</td>
<td>11</td>
<td>	,m_clock()</td>
</tr>
<tr>
<td>12</td>
<td>12</td>
<td>	,m_window(window)</td>
</tr>
<tr>
<td>13</td>
<td>13</td>
<td>{</td>
</tr>
<tr>
<td>14</td>
<td>14</td>
<td>	m_lastFrameTime = m_clock.getElapsedTime().asMilliseconds() / 1000.f;</td>
</tr>
<tr>
<td>15</td>
<td>15</td>
<td></td>
</tr>
<tr>
<td>16</td>
<td>16</td>
<td>	InitTexts();</td>
</tr>
<tr>
<td>17</td>
<td>17</td>
<td>	InitButtons();</td>
</tr>
<tr>
<td>18</td>
<td>18</td>
<td></td>
</tr>
<tr>
<td>19</td>
<td>19</td>
<td>	m_background.setTexture(Resources::GetBackgroundTexture());</td>
</tr>
<tr>
<td>20</td>
<td>20</td>
<td>	m_background.setPosition(0.f, static_cast<float>(-WINDOW_HEIGHT));</td>
</tr>
<tr>
<td>21</td>
<td>21</td>
<td>	m_hint = new CHint(L"Kill 50 enemies to win!", Vector2f(WINDOW_WIDTH / 2, WINDOW_HEIGHT / 2), 72, TARGET_HINT_TIME);</td>
</tr>
<tr>
<td>22</td>
<td>22</td>
<td>}</td>
</tr>
<tr>
<td>23</td>
<td>23</td>
<td></td>
</tr>
<tr>
<td>24</td>
<td>24</td>
<td>void CLevel::InitTexts()</td>
</tr>
<tr>
<td>25</td>
<td>25</td>
<td>{</td>
</tr>
<tr>
<td>26</td>
<td>26</td>
<td>	m_healthText = new CText;</td>
</tr>
<tr>
<td>27</td>
<td>27</td>
<td>	m_healthText->SetString(L"HP: " + to_string(m_player->GetHealth()));</td>
</tr>
<tr>
<td>28</td>
<td>28</td>
<td>	m_healthText->SetPosition(Vector2f(0, 0));</td>
</tr>
<tr>
<td>29</td>
<td>29</td>
<td></td>
</tr>
<tr>
<td>30</td>
<td>30</td>
<td>	m_scoreText = new CText;</td>
</tr>
<tr>
<td>31</td>
<td>31</td>
<td>	m_scoreText->SetString(L"Score: " + to_string(m_score));</td>
</tr>
<tr>
<td>32</td>
<td>32</td>
<td>	m_scoreText->SetPosition(Vector2f(0, m_healthText->GetBottomBound() + TEXT_MARGIN));</td>
</tr>
<tr>
<td>33</td>
<td>33</td>
<td></td>
</tr>
<tr>
<td>34</td>
<td>34</td>
<td>	m_targetText = new CText;</td>
</tr>
<tr>
<td>35</td>
<td>35</td>
<td>	m_targetText->SetString(L"Kills: " + to_string(m_kills) + '/' + to_string(TARGET));</td>
</tr>
<tr>
<td>36</td>
<td>36</td>
<td>	m_targetText->SetPosition(Vector2f(0, m_scoreText->GetBottomBound() + TEXT_MARGIN));</td>
</tr>
<tr>
<td>37</td>
<td>37</td>
<td>}</td>
</tr>
<tr>
<td>38</td>
<td>38</td>
<td></td>
</tr>
<tr>
<td>39</td>
<td>39</td>
<td>void CLevel::InitButtons()</td>
</tr>
<tr>
<td>40</td>
<td>40</td>
<td>{</td>
</tr>
<tr>
<td>41</td>
<td>41</td>
<td>	Vector2f position;</td>
</tr>
<tr>
<td>42</td>
<td>42</td>
<td>	m_continueButton = new CTextButton;</td>
</tr>
<tr>
<td>43</td>
<td>43</td>
<td>	m_continueButton->SetString(L"Continue");</td>
</tr>
<tr>
<td>44</td>
<td>44</td>
<td>	m_continueButton->SetCharacterSize(72);</td>
</tr>
<tr>
<td>45</td>
<td>45</td>
<td>	position.x = WINDOW_WIDTH / 2 - m_continueButton->GetWidth() / 2;</td>
</tr>
<tr>
<td>46</td>
<td>46</td>
<td>	position.y = WINDOW_HEIGHT / 2 - m_continueButton->GetHeight();</td>
</tr>
<tr>
<td>47</td>
<td>47</td>
<td>	m_continueButton->SetPosition(position);</td>
</tr>
<tr>
<td>48</td>
<td>48</td>
<td></td>
</tr>
<tr>
<td>49</td>
<td>49</td>
<td>	m_exitButton = new CTextButton;</td>
</tr>
<tr>
<td>50</td>
<td>50</td>
<td>	m_exitButton->SetString(L"Main menu");</td>
</tr>
<tr>
<td>51</td>
<td>51</td>
<td>	m_exitButton->SetCharacterSize(72);</td>
</tr>
<tr>
<td>52</td>
<td>52</td>
<td>	position.x = WINDOW_WIDTH / 2 - m_exitButton->GetWidth() / 2;</td>
</tr>
<tr>
<td>53</td>
<td>53</td>
<td>	position.y = m_continueButton->GetBottomBound() + TEXT_MARGIN;</td>
</tr>
<tr>
<td>54</td>
<td>54</td>
<td>	m_exitButton->SetPosition(position);</td>
</tr>
<tr>
<td>55</td>
<td>55</td>
<td>}</td>
</tr>
<tr>
<td>56</td>
<td>56</td>
<td></td>
</tr>
<tr>
<td>57</td>
<td>57</td>
<td>void CLevel::UpdateBackground(float deltaTime)</td>
</tr>
<tr>
<td>58</td>
<td>58</td>
<td>{</td>
</tr>
<tr>
<td>59</td>
<td>59</td>
<td>	m_background.move(0.f, BACKGROUND_SPEED * deltaTime * m_slowMultiplier);</td>
</tr>
<tr>
<td>60</td>
<td>60</td>
<td>	if (m_background.getPosition().y >= 0)</td>
</tr>
<tr>
<td>61</td>
<td>61</td>
<td>	{</td>
</tr>
<tr>
<td>62</td>
<td>62</td>
<td>		m_background.setPosition(0.f, static_cast<float>(-WINDOW_HEIGHT));</td>
</tr>
<tr>
<td>63</td>
<td>63</td>
<td>	}</td>
</tr>
<tr>
<td>64</td>
<td>64</td>
<td>}</td>
</tr>
<tr>
<td>65</td>
<td>65</td>
<td></td>
</tr>
<tr>
<td>66</td>
<td>66</td>
<td>void CLevel::Draw() const</td>
</tr>
<tr>
<td>67</td>
<td>67</td>
<td>{</td>
</tr>
<tr>
<td>68</td>
<td>68</td>
<td>	m_window.clear(Color::White);</td>
</tr>
<tr>
<td>69</td>
<td>69</td>
<td>	m_window.setMouseCursorVisible(false);</td>
</tr>
<tr>
<td>70</td>
<td>70</td>
<td>	m_window.draw(m_background);</td>
</tr>
<tr>
<td>71</td>
<td>71</td>
<td></td>
</tr>
<tr>
<td>72</td>
<td>72</td>
<td>	if (!isStopped)</td>
</tr>
<tr>
<td>73</td>
<td>73</td>
<td>	{</td>
</tr>
<tr>
<td>74</td>
<td>74</td>
<td>		for (auto laser : m_lasers)</td>
</tr>
<tr>
<td>75</td>
<td>75</td>
<td>		{</td>
</tr>
<tr>
<td>76</td>
<td>76</td>
<td>			m_window.draw(laser->GetShape());</td>
</tr>
<tr>
<td>77</td>
<td>77</td>
<td>		}</td>
</tr>
<tr>
<td>78</td>
<td>78</td>
<td>		for (auto shooter : m_shooters)</td>
</tr>
<tr>
<td>79</td>
<td>79</td>
<td>		{</td>
</tr>
<tr>
<td>80</td>
<td>80</td>
<td>			m_window.draw(shooter->GetShape());</td>
</tr>
<tr>
<td>81</td>
<td>81</td>
<td>		}</td>
</tr>
<tr>
<td>82</td>
<td>82</td>
<td>		for (auto asteroid : m_asteroids)</td>
</tr>
<tr>
<td>83</td>
<td>83</td>
<td>		{</td>
</tr>
<tr>
<td>84</td>
<td>84</td>
<td>			m_window.draw(asteroid->GetShape());</td>
</tr>
<tr>
<td>85</td>
<td>85</td>
<td>		}</td>
</tr>
<tr>
<td>86</td>
<td>86</td>
<td>		m_window.draw(m_player->GetShape());</td>
</tr>
<tr>
<td>87</td>
<td>87</td>
<td>		m_window.draw(m_healthText->GetShape());</td>
</tr>
<tr>
<td>88</td>
<td>88</td>
<td>		m_window.draw(m_targetText->GetShape());</td>
</tr>
<tr>
<td>89</td>
<td>89</td>
<td>		if (m_bonus != nullptr)</td>
</tr>
<tr>
<td>90</td>
<td>90</td>
<td>			m_window.draw(m_bonus->GetShape());</td>
</tr>
<tr>
<td>91</td>
<td>91</td>
<td>		if (m_hint != nullptr)</td>
</tr>
<tr>
<td>92</td>
<td>92</td>
<td>			m_window.draw(m_hint->GetShape());</td>
</tr>
<tr>
<td>93</td>
<td>93</td>
<td></td>
</tr>
<tr>
<td>94</td>
<td>94</td>
<td>		for (auto animation : m_animations)</td>
</tr>
<tr>
<td>95</td>
<td>95</td>
<td>		{</td>
</tr>
<tr>
<td>96</td>
<td>96</td>
<td>			m_window.draw(animation->GetShape());</td>
</tr>
<tr>
<td>97</td>
<td>97</td>
<td>		}</td>
</tr>
<tr>
<td>98</td>
<td>98</td>
<td>	}</td>
</tr>
<tr>
<td>99</td>
<td>99</td>
<td>	else</td>
</tr>
<tr>
<td>100</td>
<td>100</td>
<td>	{</td>
</tr>
<tr>
<td>101</td>
<td>101</td>
<td>		m_window.draw(m_gameEndText->GetShape());</td>
</tr>
<tr>
<td>102</td>
<td>102</td>
<td>	}</td>
</tr>
<tr>
<td>103</td>
<td>103</td>
<td></td>
</tr>
<tr>
<td>104</td>
<td>104</td>
<td>	if (isPaused || isStopped)</td>
</tr>
<tr>
<td>105</td>
<td>105</td>
<td>	{</td>
</tr>
<tr>
<td>106</td>
<td>106</td>
<td>		m_window.draw(m_continueButton->GetShape());</td>
</tr>
<tr>
<td>107</td>
<td>107</td>
<td>		m_window.draw(m_exitButton->GetShape());</td>
</tr>
<tr>
<td>108</td>
<td>108</td>
<td>		m_window.setMouseCursorVisible(true);</td>
</tr>
<tr>
<td>109</td>
<td>109</td>
<td>	}</td>
</tr>
<tr>
<td>110</td>
<td>110</td>
<td>	m_window.draw(m_scoreText->GetShape());</td>
</tr>
<tr>
<td>111</td>
<td>111</td>
<td></td>
</tr>
<tr>
<td>112</td>
<td>112</td>
<td>	m_window.display();</td>
</tr>
<tr>
<td>113</td>
<td>113</td>
<td>}</td>
</tr>
<tr>
<td>114</td>
<td>114</td>
<td></td>
</tr>
<tr>
<td>115</td>
<td>115</td>
<td>void CLevel::CheckEvents()</td>
</tr>
<tr>
<td>116</td>
<td>116</td>
<td>{</td>
</tr>
<tr>
<td>117</td>
<td>117</td>
<td>	Event event;</td>
</tr>
<tr>
<td>118</td>
<td>118</td>
<td>	while (m_window.pollEvent(event))</td>
</tr>
<tr>
<td>119</td>
<td>119</td>
<td>	{</td>
</tr>
<tr>
<td>120</td>
<td>120</td>
<td>		switch (event.type)</td>
</tr>
<tr>
<td>121</td>
<td>121</td>
<td>		{</td>
</tr>
<tr>
<td>122</td>
<td>122</td>
<td>		case Event::Closed:</td>
</tr>
<tr>
<td>123</td>
<td>123</td>
<td>			m_window.close();</td>
</tr>
<tr>
<td>124</td>
<td>124</td>
<td>			break;</td>
</tr>
<tr>
<td>125</td>
<td>125</td>
<td>		case Event::KeyReleased:</td>
</tr>
<tr>
<td>126</td>
<td>126</td>
<td>			if (event.key.code == Keyboard::Escape)</td>
</tr>
<tr>
<td>127</td>
<td>127</td>
<td>			{</td>
</tr>
<tr>
<td>128</td>
<td>128</td>
<td>				PauseGame();</td>
</tr>
<tr>
<td>129</td>
<td>129</td>
<td>			}</td>
</tr>
<tr>
<td>130</td>
<td>130</td>
<td>			break;</td>
</tr>
<tr>
<td>131</td>
<td>131</td>
<td>		case Event::MouseButtonReleased:</td>
</tr>
<tr>
<td>132</td>
<td>132</td>
<td>			CheckMouseClick(event.mouseButton.x, event.mouseButton.y);</td>
</tr>
<tr>
<td>133</td>
<td>133</td>
<td>			break;</td>
</tr>
<tr>
<td>134</td>
<td>134</td>
<td>		}</td>
</tr>
<tr>
<td>135</td>
<td>135</td>
<td>	}</td>
</tr>
<tr>
<td>136</td>
<td>136</td>
<td>}</td>
</tr>
<tr>
<td>137</td>
<td>137</td>
<td></td>
</tr>
<tr>
<td>138</td>
<td>138</td>
<td>void CLevel::CheckMouseClick(int x, int y)</td>
</tr>
<tr>
<td>139</td>
<td>139</td>
<td>{</td>
</tr>
<tr>
<td>140</td>
<td>140</td>
<td>	FloatRect mouse(static_cast<float>(x), static_cast<float>(y), 1, 1);</td>
</tr>
<tr>
<td>141</td>
<td>141</td>
<td>	if (m_continueButton->IsHovered(Mouse::getPosition()))</td>
</tr>
<tr>
<td>142</td>
<td>142</td>
<td>	{</td>
</tr>
<tr>
<td>143</td>
<td>143</td>
<td>		if (isPaused)</td>
</tr>
<tr>
<td>144</td>
<td>144</td>
<td>		{</td>
</tr>
<tr>
<td>145</td>
<td>145</td>
<td>			PauseGame();</td>
</tr>
<tr>
<td>146</td>
<td>146</td>
<td>		}</td>
</tr>
<tr>
<td>147</td>
<td>147</td>
<td>		if (isStopped)</td>
</tr>
<tr>
<td>148</td>
<td>148</td>
<td>		{</td>
</tr>
<tr>
<td>149</td>
<td>149</td>
<td>			m_result.code = ResultCode::RESTART;</td>
</tr>
<tr>
<td>150</td>
<td>150</td>
<td>			m_result.data = 1;</td>
</tr>
<tr>
<td>151</td>
<td>151</td>
<td>		}</td>
</tr>
<tr>
<td>152</td>
<td>152</td>
<td>		return;</td>
</tr>
<tr>
<td>153</td>
<td>153</td>
<td>	}</td>
</tr>
<tr>
<td>154</td>
<td>154</td>
<td>	if (m_exitButton->IsHovered(Mouse::getPosition()))</td>
</tr>
<tr>
<td>155</td>
<td>155</td>
<td>	{</td>
</tr>
<tr>
<td>156</td>
<td>156</td>
<td>		m_result.code = ResultCode::RETURN;</td>
</tr>
<tr>
<td>157</td>
<td>157</td>
<td>		m_result.data = static_cast<int>(m_score);</td>
</tr>
<tr>
<td>158</td>
<td>158</td>
<td>		return;</td>
</tr>
<tr>
<td>159</td>
<td>159</td>
<td>	}</td>
</tr>
<tr>
<td>160</td>
<td>160</td>
<td>}</td>
</tr>
<tr>
<td>161</td>
<td>161</td>
<td></td>
</tr>
<tr>
<td>162</td>
<td>162</td>
<td>void CLevel::Update()</td>
</tr>
<tr>
<td>163</td>
<td>163</td>
<td>{</td>
</tr>
<tr>
<td>164</td>
<td>164</td>
<td>	float currentTime = m_clock.getElapsedTime().asMilliseconds() / 1000.f;</td>
</tr>
<tr>
<td>165</td>
<td>165</td>
<td>	float deltaTime = currentTime - m_lastFrameTime;</td>
</tr>
<tr>
<td>166</td>
<td>166</td>
<td>	m_lastFrameTime = currentTime;</td>
</tr>
<tr>
<td>167</td>
<td>167</td>
<td></td>
</tr>
<tr>
<td>168</td>
<td>168</td>
<td>	CheckEvents();</td>
</tr>
<tr>
<td>169</td>
<td>169</td>
<td></td>
</tr>
<tr>
<td>170</td>
<td>170</td>
<td>	if (!isPaused && !isStopped)</td>
</tr>
<tr>
<td>171</td>
<td>171</td>
<td>	{</td>
</tr>
<tr>
<td>172</td>
<td>172</td>
<td>		m_gameSpeed += (1.f / GAME_SPEED_UP_RATE) * deltaTime;</td>
</tr>
<tr>
<td>173</td>
<td>173</td>
<td>		m_score += SCORE_PER_SECOND * deltaTime * m_gameSpeed;</td>
</tr>
<tr>
<td>174</td>
<td>174</td>
<td></td>
</tr>
<tr>
<td>175</td>
<td>175</td>
<td>		m_bonusTime -= deltaTime;</td>
</tr>
<tr>
<td>176</td>
<td>176</td>
<td>		m_shooterTime -= deltaTime;</td>
</tr>
<tr>
<td>177</td>
<td>177</td>
<td>		m_asteroidTime -= deltaTime;</td>
</tr>
<tr>
<td>178</td>
<td>178</td>
<td>		Generate();</td>
</tr>
<tr>
<td>179</td>
<td>179</td>
<td></td>
</tr>
<tr>
<td>180</td>
<td>180</td>
<td>		if (m_slowMultiplier < 1.f)</td>
</tr>
<tr>
<td>181</td>
<td>181</td>
<td>		{</td>
</tr>
<tr>
<td>182</td>
<td>182</td>
<td>			m_slowMultiplier += (1.f / SLOW_TIME) * deltaTime;</td>
</tr>
<tr>
<td>183</td>
<td>183</td>
<td>			if (m_slowMultiplier > 1)</td>
</tr>
<tr>
<td>184</td>
<td>184</td>
<td>				m_slowMultiplier = 1.f;</td>
</tr>
<tr>
<td>185</td>
<td>185</td>
<td>		}</td>
</tr>
<tr>
<td>186</td>
<td>186</td>
<td></td>
</tr>
<tr>
<td>187</td>
<td>187</td>
<td>		UpdateBackground(deltaTime);</td>
</tr>
<tr>
<td>188</td>
<td>188</td>
<td>		UpdatePlayer(deltaTime);</td>
</tr>
<tr>
<td>189</td>
<td>189</td>
<td>		UpdateBonus(deltaTime);</td>
</tr>
<tr>
<td>190</td>
<td>190</td>
<td>		UpdateAsteroids(deltaTime);</td>
</tr>
<tr>
<td>191</td>
<td>191</td>
<td>		UpdateShooters(deltaTime);</td>
</tr>
<tr>
<td>192</td>
<td>192</td>
<td>		UpdateAnimations(deltaTime);</td>
</tr>
<tr>
<td>193</td>
<td>193</td>
<td>		UpdateLasers(deltaTime);</td>
</tr>
<tr>
<td>194</td>
<td>194</td>
<td>		UpdateTexts(deltaTime);</td>
</tr>
<tr>
<td>195</td>
<td>195</td>
<td>	}</td>
</tr>
<tr>
<td>196</td>
<td>196</td>
<td>	else</td>
</tr>
<tr>
<td>197</td>
<td>197</td>
<td>	{</td>
</tr>
<tr>
<td>198</td>
<td>198</td>
<td>		UpdateButtons();</td>
</tr>
<tr>
<td>199</td>
<td>199</td>
<td>	}</td>
</tr>
<tr>
<td>200</td>
<td>200</td>
<td>}</td>
</tr>
<tr>
<td>201</td>
<td>201</td>
<td></td>
</tr>
<tr>
<td>202</td>
<td>202</td>
<td>Result const * CLevel::GetResult() const</td>
</tr>
<tr>
<td>203</td>
<td>203</td>
<td>{</td>
</tr>
<tr>
<td>204</td>
<td>204</td>
<td>	return &m_result;</td>
</tr>
<tr>
<td>205</td>
<td>205</td>
<td>}</td>
</tr>
<tr>
<td>206</td>
<td>206</td>
<td></td>
</tr>
<tr>
<td>207</td>
<td>207</td>
<td>void CLevel::UpdateLasers(float deltaTime)</td>
</tr>
<tr>
<td>208</td>
<td>208</td>
<td>{</td>
</tr>
<tr>
<td>209</td>
<td>209</td>
<td>	for (size_t i = 0; i < m_lasers.size(); ++i)</td>
</tr>
<tr>
<td>210</td>
<td>210</td>
<td>	{</td>
</tr>
<tr>
<td>211</td>
<td>211</td>
<td>		auto laser = m_lasers.at(i);</td>
</tr>
<tr>
<td>212</td>
<td>212</td>
<td>		laser->Update(deltaTime * m_slowMultiplier);</td>
</tr>
<tr>
<td>213</td>
<td>213</td>
<td>		if (laser->GetShape().getGlobalBounds().top >= WINDOW_HEIGHT || laser->GetPosition().y <= -LASER_HEIGHT / 2)</td>
</tr>
<tr>
<td>214</td>
<td>214</td>
<td>		{</td>
</tr>
<tr>
<td>215</td>
<td>215</td>
<td>			delete laser;</td>
</tr>
<tr>
<td>216</td>
<td>216</td>
<td>			m_lasers.erase(m_lasers.begin() + i);</td>
</tr>
<tr>
<td>217</td>
<td>217</td>
<td>			continue;</td>
</tr>
<tr>
<td>218</td>
<td>218</td>
<td>		}</td>
</tr>
<tr>
<td>219</td>
<td>219</td>
<td></td>
</tr>
<tr>
<td>220</td>
<td>220</td>
<td>		if (laser->GetType() != LaserType::RED && CheckCollision(laser, m_player))</td>
</tr>
<tr>
<td>221</td>
<td>221</td>
<td>		{</td>
</tr>
<tr>
<td>222</td>
<td>222</td>
<td>			CreateAnimation(laser->GetPosition(), AnimType::BLUE_DAMAGE);</td>
</tr>
<tr>
<td>223</td>
<td>223</td>
<td>			m_player->Hit(SHOOT_DAMAGE);</td>
</tr>
<tr>
<td>224</td>
<td>224</td>
<td>			delete laser;</td>
</tr>
<tr>
<td>225</td>
<td>225</td>
<td>			m_lasers.erase(m_lasers.begin() + i);</td>
</tr>
<tr>
<td>226</td>
<td>226</td>
<td>			continue;</td>
</tr>
<tr>
<td>227</td>
<td>227</td>
<td>		}</td>
</tr>
<tr>
<td>228</td>
<td>228</td>
<td></td>
</tr>
<tr>
<td>229</td>
<td>229</td>
<td>		for (auto shooter : m_shooters)</td>
</tr>
<tr>
<td>230</td>
<td>230</td>
<td>		{</td>
</tr>
<tr>
<td>231</td>
<td>231</td>
<td>			if (laser->GetType() != LaserType::BLUE && CheckCollision(laser, shooter))</td>
</tr>
<tr>
<td>232</td>
<td>232</td>
<td>			{</td>
</tr>
<tr>
<td>233</td>
<td>233</td>
<td>				CreateAnimation(laser->GetPosition(), AnimType::RED_DAMAGE);</td>
</tr>
<tr>
<td>234</td>
<td>234</td>
<td>				shooter->Hit(SHOOT_DAMAGE);</td>
</tr>
<tr>
<td>235</td>
<td>235</td>
<td>				delete laser;</td>
</tr>
<tr>
<td>236</td>
<td>236</td>
<td>				m_lasers.erase(m_lasers.begin() + i);</td>
</tr>
<tr>
<td>237</td>
<td>237</td>
<td>				break;</td>
</tr>
<tr>
<td>238</td>
<td>238</td>
<td>			}</td>
</tr>
<tr>
<td>239</td>
<td>239</td>
<td>		}</td>
</tr>
<tr>
<td>240</td>
<td>240</td>
<td>	}</td>
</tr>
<tr>
<td>241</td>
<td>241</td>
<td>}</td>
</tr>
<tr>
<td>242</td>
<td>242</td>
<td></td>
</tr>
<tr>
<td>243</td>
<td>243</td>
<td>void CLevel::UpdatePlayer(float deltaTime)</td>
</tr>
<tr>
<td>244</td>
<td>244</td>
<td>{</td>
</tr>
<tr>
<td>245</td>
<td>245</td>
<td>	m_player->Update(deltaTime);</td>
</tr>
<tr>
<td>246</td>
<td>246</td>
<td>	if (m_player->GetHealth() <= 0 || m_kills >= 50)</td>
</tr>
<tr>
<td>247</td>
<td>247</td>
<td>	{</td>
</tr>
<tr>
<td>248</td>
<td>248</td>
<td>		StopGame();</td>
</tr>
<tr>
<td>249</td>
<td>249</td>
<td>	}</td>
</tr>
<tr>
<td>250</td>
<td>250</td>
<td>}</td>
</tr>
<tr>
<td>251</td>
<td>251</td>
<td></td>
</tr>
<tr>
<td>252</td>
<td>252</td>
<td>void CLevel::UpdateShooters(float deltaTime)</td>
</tr>
<tr>
<td>253</td>
<td>253</td>
<td>{</td>
</tr>
<tr>
<td>254</td>
<td>254</td>
<td>	for (size_t i = 0; i < m_shooters.size(); ++i)</td>
</tr>
<tr>
<td>255</td>
<td>255</td>
<td>	{</td>
</tr>
<tr>
<td>256</td>
<td>256</td>
<td>		auto shooter = m_shooters.at(i);</td>
</tr>
<tr>
<td>257</td>
<td>257</td>
<td>		shooter->Update(deltaTime * m_slowMultiplier);</td>
</tr>
<tr>
<td>258</td>
<td>258</td>
<td></td>
</tr>
<tr>
<td>259</td>
<td>259</td>
<td>		if (shooter->GetHealth() <= 0)</td>
</tr>
<tr>
<td>260</td>
<td>260</td>
<td>		{</td>
</tr>
<tr>
<td>261</td>
<td>261</td>
<td>			CreateAnimation(shooter->GetPosition(), AnimType::SHOOTER_EXPLOSION);</td>
</tr>
<tr>
<td>262</td>
<td>262</td>
<td>			delete shooter;</td>
</tr>
<tr>
<td>263</td>
<td>263</td>
<td>			m_shooters.erase(m_shooters.begin() + i);</td>
</tr>
<tr>
<td>264</td>
<td>264</td>
<td>			m_score += SCORE_FOR_KILL * m_gameSpeed;</td>
</tr>
<tr>
<td>265</td>
<td>265</td>
<td>			++m_kills;</td>
</tr>
<tr>
<td>266</td>
<td>266</td>
<td>			continue;</td>
</tr>
<tr>
<td>267</td>
<td>267</td>
<td>		}</td>
</tr>
<tr>
<td>268</td>
<td>268</td>
<td></td>
</tr>
<tr>
<td>269</td>
<td>269</td>
<td>		if (CheckCollision(shooter, m_player))</td>
</tr>
<tr>
<td>270</td>
<td>270</td>
<td>		{</td>
</tr>
<tr>
<td>271</td>
<td>271</td>
<td>			CreateAnimation(shooter->GetPosition(), AnimType::SHOOTER_EXPLOSION);</td>
</tr>
<tr>
<td>272</td>
<td>272</td>
<td>			delete shooter;</td>
</tr>
<tr>
<td>273</td>
<td>273</td>
<td>			m_shooters.erase(m_shooters.begin() + i);</td>
</tr>
<tr>
<td>274</td>
<td>274</td>
<td>			m_score += SCORE_FOR_KILL * m_gameSpeed;</td>
</tr>
<tr>
<td>275</td>
<td>275</td>
<td>			m_player->Hit(BUMP_DAMAGE);</td>
</tr>
<tr>
<td>276</td>
<td>276</td>
<td>			++m_kills;</td>
</tr>
<tr>
<td>277</td>
<td>277</td>
<td>			continue;</td>
</tr>
<tr>
<td>278</td>
<td>278</td>
<td>		}</td>
</tr>
<tr>
<td>279</td>
<td>279</td>
<td></td>
</tr>
<tr>
<td>280</td>
<td>280</td>
<td>		if (shooter->GetShape().getGlobalBounds().top >= WINDOW_HEIGHT)</td>
</tr>
<tr>
<td>281</td>
<td>281</td>
<td>		{</td>
</tr>
<tr>
<td>282</td>
<td>282</td>
<td>			delete shooter;</td>
</tr>
<tr>
<td>283</td>
<td>283</td>
<td>			m_shooters.erase(m_shooters.begin() + i);</td>
</tr>
<tr>
<td>284</td>
<td>284</td>
<td>		}</td>
</tr>
<tr>
<td>285</td>
<td>285</td>
<td>	}</td>
</tr>
<tr>
<td>286</td>
<td>286</td>
<td>}</td>
</tr>
<tr>
<td>287</td>
<td>287</td>
<td></td>
</tr>
<tr>
<td>288</td>
<td>288</td>
<td>void CLevel::UpdateAsteroids(float deltaTime)</td>
</tr>
<tr>
<td>289</td>
<td>289</td>
<td>{</td>
</tr>
<tr>
<td>290</td>
<td>290</td>
<td>	for (size_t i = 0; i < m_asteroids.size(); ++i)</td>
</tr>
<tr>
<td>291</td>
<td>291</td>
<td>	{</td>
</tr>
<tr>
<td>292</td>
<td>292</td>
<td>		auto asteroid = m_asteroids[i];</td>
</tr>
<tr>
<td>293</td>
<td>293</td>
<td>		asteroid->Update(deltaTime * m_slowMultiplier);</td>
</tr>
<tr>
<td>294</td>
<td>294</td>
<td></td>
</tr>
<tr>
<td>295</td>
<td>295</td>
<td>		if (CheckCollision(m_player, asteroid))</td>
</tr>
<tr>
<td>296</td>
<td>296</td>
<td>		{</td>
</tr>
<tr>
<td>297</td>
<td>297</td>
<td>			CreateAnimation(asteroid->GetPosition(), AnimType::ASTEROID_EXPLOSION);</td>
</tr>
<tr>
<td>298</td>
<td>298</td>
<td>			delete asteroid;</td>
</tr>
<tr>
<td>299</td>
<td>299</td>
<td>			m_asteroids.erase(m_asteroids.begin() + i);</td>
</tr>
<tr>
<td>300</td>
<td>300</td>
<td>			m_player->Hit(BUMP_DAMAGE);</td>
</tr>
<tr>
<td>301</td>
<td>301</td>
<td>			continue;</td>
</tr>
<tr>
<td>302</td>
<td>302</td>
<td>		}</td>
</tr>
<tr>
<td>303</td>
<td>303</td>
<td>		if (asteroid->GetShape().getGlobalBounds().top >= WINDOW_HEIGHT)</td>
</tr>
<tr>
<td>304</td>
<td>304</td>
<td>		{</td>
</tr>
<tr>
<td>305</td>
<td>305</td>
<td>			delete asteroid;</td>
</tr>
<tr>
<td>306</td>
<td>306</td>
<td>			m_asteroids.erase(m_asteroids.begin() + i);</td>
</tr>
<tr>
<td>307</td>
<td>307</td>
<td>		}</td>
</tr>
<tr>
<td>308</td>
<td>308</td>
<td>	}</td>
</tr>
<tr>
<td>309</td>
<td>309</td>
<td>}</td>
</tr>
<tr>
<td>310</td>
<td>310</td>
<td></td>
</tr>
<tr>
<td>311</td>
<td>311</td>
<td>void CLevel::UpdateBonus(float deltaTime)</td>
</tr>
<tr>
<td>312</td>
<td>312</td>
<td>{</td>
</tr>
<tr>
<td>313</td>
<td>313</td>
<td>	if (m_bonus == nullptr)</td>
</tr>
<tr>
<td>314</td>
<td>314</td>
<td>		return;</td>
</tr>
<tr>
<td>315</td>
<td>315</td>
<td></td>
</tr>
<tr>
<td>316</td>
<td>316</td>
<td>	m_bonus->Update(deltaTime);</td>
</tr>
<tr>
<td>317</td>
<td>317</td>
<td>	if (CheckCollision(m_player, m_bonus))</td>
</tr>
<tr>
<td>318</td>
<td>318</td>
<td>	{</td>
</tr>
<tr>
<td>319</td>
<td>319</td>
<td>		if (m_hint != nullptr)</td>
</tr>
<tr>
<td>320</td>
<td>320</td>
<td>			delete m_hint;</td>
</tr>
<tr>
<td>321</td>
<td>321</td>
<td>		switch (m_bonus->GetType())</td>
</tr>
<tr>
<td>322</td>
<td>322</td>
<td>		{</td>
</tr>
<tr>
<td>323</td>
<td>323</td>
<td>		case HEALTH:</td>
</tr>
<tr>
<td>324</td>
<td>324</td>
<td>			m_player->GiveHealth(HEALTH_BONUS);</td>
</tr>
<tr>
<td>325</td>
<td>325</td>
<td>			m_hint = new CHint(L"+" + to_string(HEALTH_BONUS) + "HP", m_bonus->GetPosition(),</td>
</tr>
<tr>
<td>326</td>
<td>326</td>
<td>				36, BONUS_HINT_TIME);</td>
</tr>
<tr>
<td>327</td>
<td>327</td>
<td>			break;</td>
</tr>
<tr>
<td>328</td>
<td>328</td>
<td>		case SLOW_MO:</td>
</tr>
<tr>
<td>329</td>
<td>329</td>
<td>			m_slowMultiplier = SLOW_MULTIPLIER;</td>
</tr>
<tr>
<td>330</td>
<td>330</td>
<td>			m_hint = new CHint(L"Slow-mo", m_bonus->GetPosition(),</td>
</tr>
<tr>
<td>331</td>
<td>331</td>
<td>				36, BONUS_HINT_TIME);</td>
</tr>
<tr>
<td>332</td>
<td>332</td>
<td>			break;</td>
</tr>
<tr>
<td>333</td>
<td>333</td>
<td>		}</td>
</tr>
<tr>
<td>334</td>
<td>334</td>
<td></td>
</tr>
<tr>
<td>335</td>
<td>335</td>
<td>		delete m_bonus;</td>
</tr>
<tr>
<td>336</td>
<td>336</td>
<td>		m_bonus = nullptr;</td>
</tr>
<tr>
<td>337</td>
<td>337</td>
<td>		return;</td>
</tr>
<tr>
<td>338</td>
<td>338</td>
<td>	}</td>
</tr>
<tr>
<td>339</td>
<td>339</td>
<td>	if (m_bonus->GetShape().getGlobalBounds().top >= WINDOW_HEIGHT)</td>
</tr>
<tr>
<td>340</td>
<td>340</td>
<td>	{</td>
</tr>
<tr>
<td>341</td>
<td>341</td>
<td>		delete m_bonus;</td>
</tr>
<tr>
<td>342</td>
<td>342</td>
<td>		m_bonus = nullptr;</td>
</tr>
<tr>
<td>343</td>
<td>343</td>
<td>	}</td>
</tr>
<tr>
<td>344</td>
<td>344</td>
<td>}</td>
</tr>
<tr>
<td>345</td>
<td>345</td>
<td></td>
</tr>
<tr>
<td>346</td>
<td>346</td>
<td>void CLevel::UpdateAnimations(float deltaTime)</td>
</tr>
<tr>
<td>347</td>
<td>347</td>
<td>{</td>
</tr>
<tr>
<td>348</td>
<td>348</td>
<td>	for (size_t i = 0; i < m_animations.size(); ++i)</td>
</tr>
<tr>
<td>349</td>
<td>349</td>
<td>	{</td>
</tr>
<tr>
<td>350</td>
<td>350</td>
<td>		auto animation = m_animations[i];</td>
</tr>
<tr>
<td>351</td>
<td>351</td>
<td>		animation->Update(deltaTime * m_slowMultiplier);</td>
</tr>
<tr>
<td>352</td>
<td>352</td>
<td>		if (animation->IsStopped())</td>
</tr>
<tr>
<td>353</td>
<td>353</td>
<td>		{</td>
</tr>
<tr>
<td>354</td>
<td>354</td>
<td>			delete animation;</td>
</tr>
<tr>
<td>355</td>
<td>355</td>
<td>			m_animations.erase(m_animations.begin() + i);</td>
</tr>
<tr>
<td>356</td>
<td>356</td>
<td>		}</td>
</tr>
<tr>
<td>357</td>
<td>357</td>
<td>	}</td>
</tr>
<tr>
<td>358</td>
<td>358</td>
<td>}</td>
</tr>
<tr>
<td>359</td>
<td>359</td>
<td></td>
</tr>
<tr>
<td>360</td>
<td>360</td>
<td>void CLevel::UpdateTexts(float deltaTime)</td>
</tr>
<tr>
<td>361</td>
<td>361</td>
<td>{</td>
</tr>
<tr>
<td>362</td>
<td>362</td>
<td>	m_healthText->SetString(L"HP: " + to_string(m_player->GetHealth()));</td>
</tr>
<tr>
<td>363</td>
<td>363</td>
<td>	m_scoreText->SetString(L"Score: " + to_string(static_cast<int>(m_score)));</td>
</tr>
<tr>
<td>364</td>
<td>364</td>
<td>	m_targetText->SetString(L"Kills: " + to_string(m_kills) + '/' + to_string(TARGET));</td>
</tr>
<tr>
<td>365</td>
<td>365</td>
<td></td>
</tr>
<tr>
<td>366</td>
<td>366</td>
<td>	if (m_hint != nullptr)</td>
</tr>
<tr>
<td>367</td>
<td>367</td>
<td>	{</td>
</tr>
<tr>
<td>368</td>
<td>368</td>
<td>		m_hint->Update(deltaTime);</td>
</tr>
<tr>
<td>369</td>
<td>369</td>
<td>		if (m_hint->IsStopped())</td>
</tr>
<tr>
<td>370</td>
<td>370</td>
<td>		{</td>
</tr>
<tr>
<td>371</td>
<td>371</td>
<td>			delete m_hint;</td>
</tr>
<tr>
<td>372</td>
<td>372</td>
<td>			m_hint = nullptr;</td>
</tr>
<tr>
<td>373</td>
<td>373</td>
<td>		}</td>
</tr>
<tr>
<td>374</td>
<td>374</td>
<td>	}</td>
</tr>
<tr>
<td>375</td>
<td>375</td>
<td>}</td>
</tr>
<tr>
<td>376</td>
<td>376</td>
<td></td>
</tr>
<tr>
<td>377</td>
<td>377</td>
<td>void CLevel::UpdateButtons()</td>
</tr>
<tr>
<td>378</td>
<td>378</td>
<td>{</td>
</tr>
<tr>
<td>379</td>
<td>379</td>
<td>	if (m_continueButton->IsHovered(Mouse::getPosition()))</td>
</tr>
<tr>
<td>380</td>
<td>380</td>
<td>	{</td>
</tr>
<tr>
<td>381</td>
<td>381</td>
<td>		m_continueButton->Highlight();</td>
</tr>
<tr>
<td>382</td>
<td>382</td>
<td>	}</td>
</tr>
<tr>
<td>383</td>
<td>383</td>
<td>	else</td>
</tr>
<tr>
<td>384</td>
<td>384</td>
<td>	{</td>
</tr>
<tr>
<td>385</td>
<td>385</td>
<td>		m_continueButton->Unhighlight();</td>
</tr>
<tr>
<td>386</td>
<td>386</td>
<td>	}</td>
</tr>
<tr>
<td>387</td>
<td>387</td>
<td>	if (m_exitButton->IsHovered(Mouse::getPosition()))</td>
</tr>
<tr>
<td>388</td>
<td>388</td>
<td>	{</td>
</tr>
<tr>
<td>389</td>
<td>389</td>
<td>		m_exitButton->Highlight();</td>
</tr>
<tr>
<td>390</td>
<td>390</td>
<td>	}</td>
</tr>
<tr>
<td>391</td>
<td>391</td>
<td>	else</td>
</tr>
<tr>
<td>392</td>
<td>392</td>
<td>	{</td>
</tr>
<tr>
<td>393</td>
<td>393</td>
<td>		m_exitButton->Unhighlight();</td>
</tr>
<tr>
<td>394</td>
<td>394</td>
<td>	}</td>
</tr>
<tr>
<td>395</td>
<td>395</td>
<td>}</td>
</tr>
<tr>
<td>396</td>
<td>396</td>
<td></td>
</tr>
<tr>
<td>397</td>
<td>397</td>
<td>void CLevel::CreateAnimation(Vector2f position, AnimType type)</td>
</tr>
<tr>
<td>398</td>
<td>398</td>
<td>{</td>
</tr>
<tr>
<td>399</td>
<td>399</td>
<td>	CAnimRect * animRect = nullptr;</td>
</tr>
<tr>
<td>400</td>
<td>400</td>
<td>	switch (type)</td>
</tr>
<tr>
<td>401</td>
<td>401</td>
<td>	{</td>
</tr>
<tr>
<td>402</td>
<td>402</td>
<td>	case AnimType::ASTEROID_EXPLOSION:</td>
</tr>
<tr>
<td>403</td>
<td>403</td>
<td>		animRect = new CAnimRect(position, Resources::GetAsteroidExplosion(), EXPLOSION_ANIM_TIME);</td>
</tr>
<tr>
<td>404</td>
<td>404</td>
<td>		break;</td>
</tr>
<tr>
<td>405</td>
<td>405</td>
<td>	case AnimType::SHOOTER_EXPLOSION:</td>
</tr>
<tr>
<td>406</td>
<td>406</td>
<td>		animRect = new CAnimRect(position, Resources::GetShooterExplosion(), EXPLOSION_ANIM_TIME);</td>
</tr>
<tr>
<td>407</td>
<td>407</td>
<td>		break;</td>
</tr>
<tr>
<td>408</td>
<td>408</td>
<td>	case AnimType::RED_DAMAGE:</td>
</tr>
<tr>
<td>409</td>
<td>409</td>
<td>		animRect = new CAnimRect(position, Resources::GetRedDamage(), DAMAGE_ANIM_TIME);</td>
</tr>
<tr>
<td>410</td>
<td>410</td>
<td>		break;</td>
</tr>
<tr>
<td>411</td>
<td>411</td>
<td>	case AnimType::BLUE_DAMAGE:</td>
</tr>
<tr>
<td>412</td>
<td>412</td>
<td>		animRect = new CAnimRect(position, Resources::GetBlueDamage(), DAMAGE_ANIM_TIME);</td>
</tr>
<tr>
<td>413</td>
<td>413</td>
<td>		break;</td>
</tr>
<tr>
<td>414</td>
<td>414</td>
<td>	}</td>
</tr>
<tr>
<td>415</td>
<td>415</td>
<td></td>
</tr>
<tr>
<td>416</td>
<td>416</td>
<td>	m_animations.push_back(animRect);</td>
</tr>
<tr>
<td>417</td>
<td>417</td>
<td>}</td>
</tr>
<tr>
<td>418</td>
<td>418</td>
<td></td>
</tr>
<tr>
<td>419</td>
<td>419</td>
<td>void CLevel::Generate()</td>
</tr>
<tr>
<td>420</td>
<td>420</td>
<td>{</td>
</tr>
<tr>
<td>421</td>
<td>421</td>
<td>	float x;</td>
</tr>
<tr>
<td>422</td>
<td>422</td>
<td></td>
</tr>
<tr>
<td>423</td>
<td>423</td>
<td>	if (m_bonusTime <= 0)</td>
</tr>
<tr>
<td>424</td>
<td>424</td>
<td>	{</td>
</tr>
<tr>
<td>425</td>
<td>425</td>
<td>		x = static_cast<float>(WINDOW_WIDTH / 3 + rand() % static_cast<int>(WINDOW_WIDTH / 3 - BONUS_WIDTH));</td>
</tr>
<tr>
<td>426</td>
<td>426</td>
<td>		m_bonus = new CBonus(Vector2f(static_cast<float>(x), -BONUS_HEIGHT));</td>
</tr>
<tr>
<td>427</td>
<td>427</td>
<td>		m_bonusTime = BONUS_GENERATION;</td>
</tr>
<tr>
<td>428</td>
<td>428</td>
<td>	}</td>
</tr>
<tr>
<td>429</td>
<td>429</td>
<td></td>
</tr>
<tr>
<td>430</td>
<td>430</td>
<td>	if (m_asteroidTime <= 0)</td>
</tr>
<tr>
<td>431</td>
<td>431</td>
<td>	{</td>
</tr>
<tr>
<td>432</td>
<td>432</td>
<td>		x = static_cast<float>(rand() % static_cast<int>(WINDOW_WIDTH - MAX_ASTEROID_WIDTH));</td>
</tr>
<tr>
<td>433</td>
<td>433</td>
<td>		CAsteroid * asteroid = new CAsteroid(Vector2f(x, -MAX_ASTEROID_HEIGHT));</td>
</tr>
<tr>
<td>434</td>
<td>434</td>
<td>		m_asteroids.push_back(asteroid);</td>
</tr>
<tr>
<td>435</td>
<td>435</td>
<td>		m_asteroidTime = ASTEROID_GENERATION / m_slowMultiplier / m_gameSpeed;</td>
</tr>
<tr>
<td>436</td>
<td>436</td>
<td>	}</td>
</tr>
<tr>
<td>437</td>
<td>437</td>
<td></td>
</tr>
<tr>
<td>438</td>
<td>438</td>
<td>	if (m_shooterTime <= 0)</td>
</tr>
<tr>
<td>439</td>
<td>439</td>
<td>	{</td>
</tr>
<tr>
<td>440</td>
<td>440</td>
<td>		CShooter * shooter;</td>
</tr>
<tr>
<td>441</td>
<td>441</td>
<td>		x = static_cast<float>(rand() % static_cast<int>(WINDOW_WIDTH - SHOOTER_WIDTH * 6));</td>
</tr>
<tr>
<td>442</td>
<td>442</td>
<td></td>
</tr>
<tr>
<td>443</td>
<td>443</td>
<td>		for (int i = 0; i < 3; ++i)</td>
</tr>
<tr>
<td>444</td>
<td>444</td>
<td>		{</td>
</tr>
<tr>
<td>445</td>
<td>445</td>
<td>			shooter = new CShooter(Vector2f(x, -SHOOTER_HEIGHT), m_lasers);</td>
</tr>
<tr>
<td>446</td>
<td>446</td>
<td>			m_shooters.push_back(shooter);</td>
</tr>
<tr>
<td>447</td>
<td>447</td>
<td>			x += SHOOTER_WIDTH * 2;</td>
</tr>
<tr>
<td>448</td>
<td>448</td>
<td>		}</td>
</tr>
<tr>
<td>449</td>
<td>449</td>
<td></td>
</tr>
<tr>
<td>450</td>
<td>450</td>
<td>		m_shooterTime = SHOOTER_GENERATION;</td>
</tr>
<tr>
<td>451</td>
<td>451</td>
<td>	}</td>
</tr>
<tr>
<td>452</td>
<td>452</td>
<td>}</td>
</tr>
<tr>
<td>453</td>
<td>453</td>
<td></td>
</tr>
<tr>
<td>454</td>
<td>454</td>
<td>void CLevel::PauseGame()</td>
</tr>
<tr>
<td>455</td>
<td>455</td>
<td>{</td>
</tr>
<tr>
<td>456</td>
<td>456</td>
<td>	isPaused = !isPaused;</td>
</tr>
<tr>
<td>457</td>
<td>457</td>
<td>}</td>
</tr>
<tr>
<td>458</td>
<td>458</td>
<td></td>
</tr>
<tr>
<td>459</td>
<td>459</td>
<td>void CLevel::StopGame()</td>
</tr>
<tr>
<td>460</td>
<td>460</td>
<td>{</td>
</tr>
<tr>
<td>461</td>
<td>461</td>
<td>	isStopped = true;</td>
</tr>
<tr>
<td>462</td>
<td>462</td>
<td>	m_gameEndText = new CText;</td>
</tr>
<tr>
<td>463</td>
<td>463</td>
<td>	m_gameEndText->SetCharacterSize(72);</td>
</tr>
<tr>
<td>464</td>
<td>464</td>
<td></td>
</tr>
<tr>
<td>465</td>
<td>465</td>
<td>	if (m_player->GetHealth() <= 0)</td>
</tr>
<tr>
<td>466</td>
<td>466</td>
<td>	{</td>
</tr>
<tr>
<td>467</td>
<td>467</td>
<td>		m_gameEndText->SetString(L"You lose");</td>
</tr>
<tr>
<td>468</td>
<td>468</td>
<td>	}</td>
</tr>
<tr>
<td>469</td>
<td>469</td>
<td>	else</td>
</tr>
<tr>
<td>470</td>
<td>470</td>
<td>	{</td>
</tr>
<tr>
<td>471</td>
<td>471</td>
<td>		m_gameEndText->SetString(L"You won! (+50000)");</td>
</tr>
<tr>
<td>472</td>
<td>472</td>
<td>		m_score += 50000;</td>
</tr>
<tr>
<td>473</td>
<td>473</td>
<td>		m_scoreText->SetString(L"Score: " + to_string(static_cast<int>(m_score)));</td>
</tr>
<tr>
<td>474</td>
<td>474</td>
<td>	}</td>
</tr>
<tr>
<td>475</td>
<td>475</td>
<td></td>
</tr>
<tr>
<td>476</td>
<td>476</td>
<td>	Vector2f position;</td>
</tr>
<tr>
<td>477</td>
<td>477</td>
<td>	position.x = WINDOW_WIDTH / 2 - m_gameEndText->GetWidth() / 2;</td>
</tr>
<tr>
<td>478</td>
<td>478</td>
<td>	position.y = WINDOW_HEIGHT / 2 - m_gameEndText->GetHeight() * 2;</td>
</tr>
<tr>
<td>479</td>
<td>479</td>
<td>	m_gameEndText->SetPosition(position);</td>
</tr>
<tr>
<td>480</td>
<td>480</td>
<td></td>
</tr>
<tr>
<td>481</td>
<td>481</td>
<td>	m_scoreText->SetCharacterSize(72);</td>
</tr>
<tr>
<td>482</td>
<td>482</td>
<td>	position.x = WINDOW_WIDTH / 2 - m_scoreText->GetWidth() / 2;</td>
</tr>
<tr>
<td>483</td>
<td>483</td>
<td>	position.y = m_gameEndText->GetBottomBound() + TEXT_MARGIN;</td>
</tr>
<tr>
<td>484</td>
<td>484</td>
<td>	m_scoreText->SetPosition(position);</td>
</tr>
<tr>
<td>485</td>
<td>485</td>
<td></td>
</tr>
<tr>
<td>486</td>
<td>486</td>
<td>	m_continueButton->SetString(L"Try again");</td>
</tr>
<tr>
<td>487</td>
<td>487</td>
<td>	position.x = WINDOW_WIDTH / 2 - m_continueButton->GetWidth() / 2;</td>
</tr>
<tr>
<td>488</td>
<td>488</td>
<td>	position.y = m_scoreText->GetBottomBound() + m_continueButton->GetHeight() + TEXT_MARGIN;</td>
</tr>
<tr>
<td>489</td>
<td>489</td>
<td>	m_continueButton->SetPosition(position);</td>
</tr>
<tr>
<td>490</td>
<td>490</td>
<td></td>
</tr>
<tr>
<td>491</td>
<td>491</td>
<td>	position.x = WINDOW_WIDTH / 2 - m_exitButton->GetWidth() / 2;</td>
</tr>
<tr>
<td>492</td>
<td>492</td>
<td>	position.y = m_continueButton->GetBottomBound() + TEXT_MARGIN;</td>
</tr>
<tr>
<td>493</td>
<td>493</td>
<td>	m_exitButton->SetPosition(position);</td>
</tr>
<tr>
<td>494</td>
<td>494</td>
<td>}</td>
</tr>
<tr>
<td>495</td>
<td>495</td>
<td></td>
</tr>
<tr>
<td>496</td>
<td>496</td>
<td>bool CLevel::CheckCollision(IObject * first, IObject * second)</td>
</tr>
<tr>
<td>497</td>
<td>497</td>
<td>{</td>
</tr>
<tr>
<td>498</td>
<td>498</td>
<td>	static FloatRect firstCorrected;</td>
</tr>
<tr>
<td>499</td>
<td>499</td>
<td>	static FloatRect secondCorrected;</td>
</tr>
<tr>
<td>500</td>
<td>500</td>
<td></td>
</tr>
<tr>
<td>501</td>
<td>501</td>
<td>	FloatRect firstRect = first->GetShape().getGlobalBounds();</td>
</tr>
<tr>
<td>502</td>
<td>502</td>
<td>	firstCorrected.left = firstRect.left + firstRect.width * 0.05f;</td>
</tr>
<tr>
<td>503</td>
<td>503</td>
<td>	firstCorrected.top = firstRect.top + firstRect.height * 0.05f;</td>
</tr>
<tr>
<td>504</td>
<td>504</td>
<td>	firstCorrected.height = firstRect.height * 0.9f;</td>
</tr>
<tr>
<td>505</td>
<td>505</td>
<td>	firstCorrected.width = firstRect.width * 0.9f;</td>
</tr>
<tr>
<td>506</td>
<td>506</td>
<td></td>
</tr>
<tr>
<td>507</td>
<td>507</td>
<td>	FloatRect secondRect = second->GetShape().getGlobalBounds();</td>
</tr>
<tr>
<td>508</td>
<td>508</td>
<td>	secondCorrected.left = secondRect.left + secondRect.width * 0.05f;</td>
</tr>
<tr>
<td>509</td>
<td>509</td>
<td>	secondCorrected.top = secondRect.top + secondRect.height * 0.05f;</td>
</tr>
<tr>
<td>510</td>
<td>510</td>
<td>	secondCorrected.height = secondRect.height * 0.9f;</td>
</tr>
<tr>
<td>511</td>
<td>511</td>
<td>	secondCorrected.width = secondRect.width * 0.9f;</td>
</tr>
<tr>
<td>512</td>
<td>512</td>
<td></td>
</tr>
<tr>
<td>513</td>
<td>513</td>
<td>	return firstCorrected.intersects(secondCorrected);</td>
</tr>
<tr>
<td>514</td>
<td>514</td>
<td>}</td>
</tr>
<tr>
<td>515</td>
<td>515</td>
<td></td>
</tr>
<tr>
<td>516</td>
<td>516</td>
<td>CLevel::~CLevel()</td>
</tr>
<tr>
<td>517</td>
<td>517</td>
<td>{</td>
</tr>
<tr>
<td>518</td>
<td>518</td>
<td>	delete m_player;</td>
</tr>
<tr>
<td>519</td>
<td>519</td>
<td>	delete m_healthText;</td>
</tr>
<tr>
<td>520</td>
<td>520</td>
<td>	delete m_scoreText;</td>
</tr>
<tr>
<td>521</td>
<td>521</td>
<td>	delete m_targetText;</td>
</tr>
<tr>
<td>522</td>
<td>522</td>
<td>	delete m_continueButton;</td>
</tr>
<tr>
<td>523</td>
<td>523</td>
<td>	delete m_exitButton;</td>
</tr>
<tr>
<td>524</td>
<td>524</td>
<td></td>
</tr>
<tr>
<td>525</td>
<td>525</td>
<td>	if (m_gameEndText != nullptr)</td>
</tr>
<tr>
<td>526</td>
<td>526</td>
<td>		delete m_gameEndText;</td>
</tr>
<tr>
<td>527</td>
<td>527</td>
<td>	if (m_bonus != nullptr)</td>
</tr>
<tr>
<td>528</td>
<td>528</td>
<td>		delete m_bonus;</td>
</tr>
<tr class="added">
<td> </td>
<td>529</td>
<td>	if (m_hint != nullptr)</td>
</tr>
<tr class="added">
<td> </td>
<td>530</td>
<td>		delete m_hint;</td>
</tr>
<tr>
<td>529</td>
<td>531</td>
<td></td>
</tr>
<tr>
<td>530</td>
<td>532</td>
<td>	for (auto laser : m_lasers)</td>
</tr>
<tr>
<td>531</td>
<td>533</td>
<td>		delete laser;</td>
</tr>
<tr>
<td>532</td>
<td>534</td>
<td>	for (auto shooter : m_shooters)</td>
</tr>
<tr>
<td>533</td>
<td>535</td>
<td>		delete shooter;</td>
</tr>
<tr>
<td>534</td>
<td>536</td>
<td>	for (auto asteroid : m_asteroids)</td>
</tr>
<tr>
<td>535</td>
<td>537</td>
<td>		delete asteroid;</td>
</tr>
<tr>
<td>536</td>
<td>538</td>
<td>}</td>
</tr>
<tr>
<td>537</td>
<td>539</td>
<td></td>
</tr>
<tr>
<td>538</td>
<td>540</td>
<td>/*</td>
</tr>
<tr>
<td>539</td>
<td>541</td>
<td>1. Òèï ñíàðÿäà, òðàåêòîðèÿ, òèï ïîâðåæäåíèé</td>
</tr>
<tr>
<td>540</td>
<td>542</td>
<td>2. Àíèìàöèè âçðûâà, ïîë¸òà, ïîâðåæäåíèé</td>
</tr>
<tr>
<td>541</td>
<td>543</td>
<td>3. Àñòåðîèäû, êîòîðûå êðóòÿòñÿ, è ëåòÿò íå òîëüêî âåðòèêàëüíî</td>
</tr>
<tr>
<td>542</td>
<td>544</td>
<td>*/</td>
</tr>

    </table>
</body>
</html>
